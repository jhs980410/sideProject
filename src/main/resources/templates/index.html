<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>ë©”ì¸í™”ë©´</title>
    <script src="https://code.jquery.com/jquery-3.7.1.js"
            integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
            crossorigin="anonymous">
    </script>
    <link rel="stylesheet" href="/css/main.css">
</head>
<body>
<header>
    <div class="header_top">
        <input class="area" type="button" value="" onclick="">
        <input class="area" type="button" value="" onclick="">
        <input class="area" type="button" value="" onclick="">
        <input class="area" type="button" value="" onclick="">
        <input class="area" type="button" value="" onclick="">
        <input class="area" type="button" value="" onclick="">
        <input class="area" type="button" value="" onclick="">
        <input class="area" type="button" value="" onclick="">
        <input class="area" type="button" value="" onclick="">
        <input class="area" type="button" value="" onclick="">


    </div>
    <div style="text-align: center; margin-top: 10px;">
        <button class="btn btn-outline-primary" onclick="location.href='/map/naver'">
            ğŸ“ ì „ì²´ ì§€ë„ ë³´ê¸°
        </button>
    </div>
</header>

<main class="main-container">
    <!-- íƒ€ì´í‹€ -->


    <!-- í•„í„° / ì •ë ¬ ì˜µì…˜ (ì„ íƒ ì‚¬í•­) -->
    <section class="section-filter">
        <select class="filter-region">
            <option value="">ì „ì²´ ì§€ì—­</option>
            <option value="1">ì„œìš¸</option>
            <option value="2">ì¸ì²œ</option>
            <option value="3">ëŒ€ì „</option>
            <option value="4">ëŒ€êµ¬</option>
            <option value="5">ê´‘ì£¼</option>
            <option value="6">ë¶€ì‚°</option>
            <option value="7">ìš¸ì‚°</option>
            <option value="8">ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ</option>
            <option value="31">ê²½ê¸°ë„</option>
            <option value="32">ê°•ì›íŠ¹ë³„ìì¹˜ë„</option>
        </select>


        <label>
            <select class="filter-sort">
                <option value="popular">ì¸ê¸°ìˆœ</option>
                <option value="latest">ìµœì‹ ìˆœ</option>
            </select>
        </label>
    </section>

    <!-- ê´€ê´‘ì§€ ì¹´ë“œ ë¦¬ìŠ¤íŠ¸ -->
    <section class="tour-list">
        <!-- JSë¡œ ì•„ë˜ ì¹´ë“œ ì—¬ëŸ¬ ê°œ ë™ì  ìƒì„± -->


    </section>
</main>

<script th:inline="javascript">
    let areaObj = [[${areaJson}]];
    let areaJsonTxt = JSON.parse(areaObj);

    let areaJsonList = areaJsonTxt.response.body.items.item;
    $(".area").each(function(index) {
        $(this).val(areaJsonList[index].name);
        $(this).attr("data-code", areaJsonList[index].code);
    });

    let festivalObj = [[${festivalJson}]];
    let festivalJsonTxt = JSON.parse(festivalObj);
    let festivalJsonList = festivalJsonTxt.response.body.items.item;

    let currentIndex = 0;
    let slideCount = 4;

    function getCurrentSlideItems() {
        let endIndex = currentIndex + slideCount;
        let sliced = [];

        for (let i = 0; i < slideCount; i++) {
            let idx = (currentIndex + i) % festivalJsonList.length;
            sliced.push(festivalJsonList[idx]);
        }

        return sliced;
    }


    function formatDate(dateStr) {
        if (!dateStr || dateStr.length !== 8) return "-";
        const year = dateStr.substring(0, 4);
        const month = dateStr.substring(4, 6);
        const day = dateStr.substring(6, 8);
        return `${year}.${month}.${day}`;
    }


    function nextSlide() {
        currentIndex += 1;
        if (currentIndex >= festivalJsonList.length) {
            currentIndex = 0;
        }
        renderSlide(getCurrentSlideItems());
    }


    function renderSlide(items) {
        const container = document.querySelector(".tour-list");
        container.innerHTML = "";

        items.forEach(item => {
            container.innerHTML += `
        <div class="tour-card">
            <img src="${item.firstimage}" alt="${item.title}">
            <div class="tour-info">
                <h4>${item.title}</h4>
                <p>${item.addr1}</p>
                <p>${formatDate(item.eventstartdate)} ~ ${formatDate(item.eventenddate)}</p>

            </div>
        </div>
        `;
        });
    }

    // âœ… í™”ë©´ ì§„ì… ì‹œ ìµœì´ˆ ë Œë”ë§
    renderSlide(getCurrentSlideItems());
    // 3ì´ˆë§ˆë‹¤ ìë™ìœ¼ë¡œ ë‹¤ìŒ ìŠ¬ë¼ì´ë“œ
    setInterval(nextSlide, 2000);

    /*item.title              // í–‰ì‚¬ëª…
    item.addr1              // ì£¼ì†Œ
    item.eventstartdate     // ì‹œì‘ì¼ (20250418 â†’ ë‚ ì§œ í¬ë§· í•„ìš”)
    item.eventenddate       // ì¢…ë£Œì¼
    item.firstimage         // ì´ë¯¸ì§€ URL
    item.contentid          // ìƒì„¸ì •ë³´ API í˜¸ì¶œìš© ID */
</script>

<!-- ì™¸ë¶€ JS íŒŒì¼ ì—°ê²° -->
<script src="/js/main.js"></script>


</body>
</html>
